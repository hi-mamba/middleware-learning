
<https://xie.infoq.cn/article/fba37afd9bda31fb10eec651f>

## [原文](http://jm.taobao.org/2017/01/12/rocketmq-quick-start-in-10-minutes/)

<https://www.cnblogs.com/qdhxhz/p/11134903.html>

[RocketMQ顺序消费的工作原理](https://www.zhihu.com/question/30195969/answer/1698410449)

# 如何保证消息有序

RocketMQ 的顺序消息分为两种种情况：`局部有序`和`全局有序`

局部有序：指发送同一个队列的消息有序，可以在发送消息时指定队列，在消费消息时也按顺序消费。
例如`同一个订单 ID `的消息要保证有序，不同订单的消息没有约束，相互不影响，不同订单 ID 之间的消息时并行的。

全局有序：设置 `Topic只有一个队列 `可以实现全局有序，创建 Topic 时手动设置。此类场景极少，性能差，通常不推荐使用
> 全局序:把所有消息都放在一个Queue里,先入先出（FIFO）的顺序进行发布和消费

在RocketMQ中提供了`基于队列(分区)`的顺序消费。

RocketMQ中`顺序`性主要指的是`消息顺序消费`

## 顺序消息的使用场景
日常项目中需要保证顺序的应用场景非常多，比如交易场景中的订单创建、支付、退款等流程，
`先创建订单才能支付`，`支付完成的订单才能退款`，这需要保证先进先出。
又例如数据库的binlog，数据库执行新增语句、修改语句，
binlog得到顺序也必须保证是新增消息、修改消息。



## Message Order
消息有序指的是一类消息消费时，能按照发送的顺序来消费。
例如：一个订单产生了3条消息，分别是订单创建，订单付款，订单完成。消费时，
要按照这个顺序消费才能有意义。但是同时订单之间是可以并行消费的。
RocketMQ可以严格的保证消息有序。

## RocketMQ顺序消费的工作原理

RocketMQ的完成顺序性主要是由3把琐来实现的


